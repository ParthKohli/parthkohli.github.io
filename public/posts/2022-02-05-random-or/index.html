<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Random OR | Parth Kohli</title>
<meta name=keywords content="math,probability"><meta name=description content="Today I&rsquo;ll discuss a probability problem from CodeChef.
The problem is as follows: we have an $N$-bit number $S$ which is initially $0$. At each step, we pick an $N$-bit number $X$ uniformly randomly and set $S := S \mid X$ (the symbol $\mid$ denotes bitwise-or). The process terminates when $S$ becomes $2^N - 1$ (that is, it is impossible to increase it any further because every bit is 1). What is the expected number of steps until termination?"><meta name=author content="Parth Kohli"><link rel=canonical href=http://localhost:1313/posts/2022-02-05-random-or/><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/2022-02-05-random-or/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css integrity=sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+ crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js integrity=sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js integrity=sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk crossorigin=anonymous onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{strict:!1,trust:!0,delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"$",right:"$",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><meta property="og:url" content="http://localhost:1313/posts/2022-02-05-random-or/"><meta property="og:site_name" content="Parth Kohli"><meta property="og:title" content="Random OR"><meta property="og:description" content="Today I’ll discuss a probability problem from CodeChef.
The problem is as follows: we have an $N$-bit number $S$ which is initially $0$. At each step, we pick an $N$-bit number $X$ uniformly randomly and set $S := S \mid X$ (the symbol $\mid$ denotes bitwise-or). The process terminates when $S$ becomes $2^N - 1$ (that is, it is impossible to increase it any further because every bit is 1). What is the expected number of steps until termination?"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-02-05T00:00:00+00:00"><meta property="article:modified_time" content="2022-02-05T00:00:00+00:00"><meta property="article:tag" content="Math"><meta property="article:tag" content="Probability"><meta property="og:image" content="http://localhost:1313/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/"><meta name=twitter:title content="Random OR"><meta name=twitter:description content="Today I&rsquo;ll discuss a probability problem from CodeChef.
The problem is as follows: we have an $N$-bit number $S$ which is initially $0$. At each step, we pick an $N$-bit number $X$ uniformly randomly and set $S := S \mid X$ (the symbol $\mid$ denotes bitwise-or). The process terminates when $S$ becomes $2^N - 1$ (that is, it is impossible to increase it any further because every bit is 1). What is the expected number of steps until termination?"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Random OR","item":"http://localhost:1313/posts/2022-02-05-random-or/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Random OR","name":"Random OR","description":"Today I\u0026rsquo;ll discuss a probability problem from CodeChef.\nThe problem is as follows: we have an $N$-bit number $S$ which is initially $0$. At each step, we pick an $N$-bit number $X$ uniformly randomly and set $S := S \\mid X$ (the symbol $\\mid$ denotes bitwise-or). The process terminates when $S$ becomes $2^N - 1$ (that is, it is impossible to increase it any further because every bit is 1). What is the expected number of steps until termination?\n","keywords":["math","probability"],"articleBody":"Today I’ll discuss a probability problem from CodeChef.\nThe problem is as follows: we have an $N$-bit number $S$ which is initially $0$. At each step, we pick an $N$-bit number $X$ uniformly randomly and set $S := S \\mid X$ (the symbol $\\mid$ denotes bitwise-or). The process terminates when $S$ becomes $2^N - 1$ (that is, it is impossible to increase it any further because every bit is 1). What is the expected number of steps until termination?\nIf you are familiar with statistical distributions, you should immediately see the goal of this problem. Don’t worry if you are not - you should be able to follow.\nThe case $N = 1$ The only two choices for $X$ are $0$ and $1$ and the process terminates as soon as we get a $1$. This is visualised as tossing a coin and waiting until the first heads. The number of steps follows a geometric distribution with $p = \\frac{1}{2}$ (again, fret not if you don’t know what that means). It is worth mentioning how to calculate the expected value even though it is covered in the samples. Let $e$ denote the expected number of tosses until we meet our first $1$. On our first step, we either obtain a $1$ with probability $\\frac{1}{2}$ or we have to “reset” the process with probability $\\frac{1}{2}$. Thus, the equation is $e = \\frac{1}{2} \\cdot 1 + \\frac{1}{2} \\cdot (1 + e)$ which yields $e = 2$.\nUnderstanding the general case The general case is visualised as follows: do the above experiment with $N$ separate coins. What is the expected value of the maximum number of trials among them? Formally, we have $N$ iid random variables $X_1, \\cdots, X_N$ all following the geometric distribution with $p = \\frac{1}{2}$. What is the value of $E[Y]$ where $Y = \\max X_i$?\nWe know by the definition of expected value that $E[Y] = \\sum_{i \\ge 1} i\\cdot P(Y = i)$. But this can also be seen as $E[Y] = \\sum_{i \\ge 1} P(Y \\ge i)$. Why? Try writing $P(Y \\ge i)$ as $P(Y = i) + P(Y = i + 1) + \\cdots$ and check that this becomes the original definition. And so, since the $N$ variables are independent,\n$$E[Y] = \\sum_{i \\ge 1} 1 - P(Y \u003c i) = \\sum_{i \\ge 1} 1 - P(X_1 \u003c i) \\cdots P(X_N \u003c i)$$\nThe probability $P(X_1 \u003c i)$ is $1 - P(X_1 \\ge i)$. Note that $P(X_1 \\ge i)$ means that you want the first $i - 1$ tosses to appear as tails the probability of which is $\\frac{1}{2^{i - 1}}$. The same goes for $X_2$ through $X_N$ as they are identically distributed. Thus,\n$$E[Y] = \\sum_{i \\ge 1} 1 - \\left(1 - \\frac{1}{2^{i-1}}\\right)^{N}$$\nAs a sanity check, try substituting $N = 1$ and see that it matches the expected value (pun not intended).\nFor brevity, we change the indexing to 0-based and denote $p = \\frac{1}{2}$. We need to calculate $\\sum_{i\\ge 0} 1 - (1 - p^i)^N$ where $N$ is fixed.\nFinishing it off Using binomial theorem, the series is\n$$S = \\sum_{i \\ge 0}\\sum_{j = 1}^{N} \\binom{N}{j} (-1)^{N - j} p^{ij}$$\nHere is the kicker: switch indexing.\n$$S = \\sum_{j = 1}^{N} \\sum_{i \\ge 0} \\binom{N}{j} (-1)^{N - j} p^{ij} = \\sum_{j = 1}^{N} \\binom{N}{j} (-1)^{N - j} \\sum_{i \\ge 0} p^{ij}$$\nOf course, we know that the inner summation is merely the geometric series and so we can finish with the result (where $p$ still denotes $\\frac{1}{2}$).\n$$S = \\sum_{j = 1}^{N} \\binom{N}{j} (-1)^{N - j} \\frac{1}{1 - p^j}$$\nThe problem is thus solved in complexity $O(N \\log(10^9 + 7))$.\nThe computation of binomial coefficients modulo a large prime is a fairly common idea in competitive programming: compute in advance the arrays $\\rm factorial[0..N]$ and $\\rm inverse\\_factorial[0..N]$ where computations are carried out modulo the prime $10^9 + 7$, that is, $\\rm inverse\\_factorial[i] \\cdot factorial[i] \\equiv 1 \\pmod {10^9 + 7}$. Computing inverses/reciprocals is done using Fermat’s theorem.\n","wordCount":"662","inLanguage":"en","image":"http://localhost:1313/","datePublished":"2022-02-05T00:00:00Z","dateModified":"2022-02-05T00:00:00Z","author":{"@type":"Person","name":"Parth Kohli"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/2022-02-05-random-or/"},"publisher":{"@type":"Organization","name":"Parth Kohli","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Home (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/categories/ title=Categories><span>Categories</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li><li><a href=http://localhost:1313/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=http://localhost:1313/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Random OR</h1><div class=post-meta><span title='2022-02-05 00:00:00 +0000 UTC'>February 5, 2022</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Parth Kohli</div></header><div class=post-content><p>Today I&rsquo;ll discuss a <a href=https://www.codechef.com/FEB221A/problems/RANDOMOR>probability problem from CodeChef</a>.</p><p>The problem is as follows: we have an $N$-bit number $S$ which is initially $0$. At each step, we pick an $N$-bit number $X$ uniformly randomly and set $S := S \mid X$ (the symbol $\mid$ denotes bitwise-or). The process terminates when $S$ becomes $2^N - 1$ (that is, it is impossible to increase it any further because every bit is 1). What is the expected number of steps until termination?</p><p>If you are familiar with statistical distributions, you should immediately see the goal of this problem. Don&rsquo;t worry if you are not - you should be able to follow.</p><h4 id=the-case-n--1>The case $N = 1$<a hidden class=anchor aria-hidden=true href=#the-case-n--1>#</a></h4><p>The only two choices for $X$ are $0$ and $1$ and the process terminates as soon as we get a $1$. This is visualised as tossing a coin and waiting until the first heads. The number of steps follows a geometric distribution with $p = \frac{1}{2}$ (again, fret not if you don&rsquo;t know what that means). It is worth mentioning how to calculate the expected value even though it is covered in the samples. Let $e$ denote the expected number of tosses until we meet our first $1$. On our first step, we either obtain a $1$ with probability $\frac{1}{2}$ or we have to &ldquo;reset&rdquo; the process with probability $\frac{1}{2}$. Thus, the equation is $e = \frac{1}{2} \cdot 1 + \frac{1}{2} \cdot (1 + e)$ which yields $e = 2$.</p><h4 id=understanding-the-general-case>Understanding the general case<a hidden class=anchor aria-hidden=true href=#understanding-the-general-case>#</a></h4><p>The general case is visualised as follows: do the above experiment with $N$ separate coins. What is the expected value of the maximum number of trials among them? Formally, we have $N$ iid random variables $X_1, \cdots, X_N$ all following the geometric distribution with $p = \frac{1}{2}$. What is the value of $E[Y]$ where $Y = \max X_i$?</p><p>We know by the definition of expected value that $E[Y] = \sum_{i \ge 1} i\cdot P(Y = i)$. But this can also be seen as $E[Y] = \sum_{i \ge 1} P(Y \ge i)$. Why? Try writing $P(Y \ge i)$ as $P(Y = i) + P(Y = i + 1) + \cdots$ and check that this becomes the original definition. And so, since the $N$ variables are independent,</p><p>$$E[Y] = \sum_{i \ge 1} 1 - P(Y &lt; i) = \sum_{i \ge 1} 1 - P(X_1 &lt; i) \cdots P(X_N &lt; i)$$</p><p>The probability $P(X_1 &lt; i)$ is $1 - P(X_1 \ge i)$. Note that $P(X_1 \ge i)$ means that you want the first $i - 1$ tosses to appear as tails the probability of which is $\frac{1}{2^{i - 1}}$. The same goes for $X_2$ through $X_N$ as they are identically distributed. Thus,</p><p>$$E[Y] = \sum_{i \ge 1} 1 - \left(1 - \frac{1}{2^{i-1}}\right)^{N}$$</p><p>As a sanity check, try substituting $N = 1$ and see that it matches the expected value (pun not intended).</p><p>For brevity, we change the indexing to 0-based and denote $p = \frac{1}{2}$. We need to calculate $\sum_{i\ge 0} 1 - (1 - p^i)^N$ where $N$ is fixed.</p><h4 id=finishing-it-off>Finishing it off<a hidden class=anchor aria-hidden=true href=#finishing-it-off>#</a></h4><p>Using binomial theorem, the series is</p><p>$$S = \sum_{i \ge 0}\sum_{j = 1}^{N} \binom{N}{j} (-1)^{N - j} p^{ij}$$</p><p>Here is the kicker: switch indexing.</p><p>$$S = \sum_{j = 1}^{N} \sum_{i \ge 0} \binom{N}{j} (-1)^{N - j} p^{ij} = \sum_{j = 1}^{N} \binom{N}{j} (-1)^{N - j} \sum_{i \ge 0} p^{ij}$$</p><p>Of course, we know that the inner summation is merely the geometric series and so we can finish with the result (where $p$ still denotes $\frac{1}{2}$).</p><p>$$S = \sum_{j = 1}^{N} \binom{N}{j} (-1)^{N - j} \frac{1}{1 - p^j}$$</p><p>The problem is thus solved in complexity $O(N \log(10^9 + 7))$.</p><p>The computation of binomial coefficients modulo a large prime is a fairly common idea in competitive programming: compute in advance the arrays $\rm factorial[0..N]$ and $\rm inverse\_factorial[0..N]$ where computations are carried out modulo the prime $10^9 + 7$, that is, $\rm inverse\_factorial[i] \cdot factorial[i] \equiv 1 \pmod {10^9 + 7}$. Computing inverses/reciprocals is done using Fermat&rsquo;s theorem.</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/math/>Math</a></li><li><a href=http://localhost:1313/tags/probability/>Probability</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/2022-02-28-generating-functions-2/><span class=title>« Prev</span><br><span>More Generating Functions</span>
</a><a class=next href=http://localhost:1313/posts/2020-08-03-generating-functions/><span class=title>Next »</span><br><span>Generating Functions</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>Parth Kohli</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>