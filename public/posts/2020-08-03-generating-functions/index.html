<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Generating Functions | Parth Kohli</title>
<meta name=keywords content="math,counting"><meta name=description content="Let&rsquo;s look at this math problem from the recent AIsing Programming Contest 2020 on AtCoder.
The problem is to compute the sum of \[\tag{1}(a_2 - a_1)(b_2 - b_1)(c_2 - c_1)(d_2 - d_1)(e_2 - e_1)\] for all tuples such that \[\tag{2} a_1 + a_2 + b_1 + b_2 + \cdots + e_1 + e_2 \le N\] where $$\tag{3} 0 \le a_1 < a_2, ~ 0 \le b_1 < b_2, \cdots,~ 0 \le e_1 < e_2$$The constraint $N \le 10^9$ makes it worse."><meta name=author content="Parth Kohli"><link rel=canonical href=http://localhost:1313/posts/2020-08-03-generating-functions/><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/2020-08-03-generating-functions/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css integrity=sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+ crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js integrity=sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js integrity=sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk crossorigin=anonymous onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{strict:!1,trust:!0,delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"$",right:"$",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><meta property="og:url" content="http://localhost:1313/posts/2020-08-03-generating-functions/"><meta property="og:site_name" content="Parth Kohli"><meta property="og:title" content="Generating Functions"><meta property="og:description" content="Let’s look at this math problem from the recent AIsing Programming Contest 2020 on AtCoder.
The problem is to compute the sum of \[\tag{1}(a_2 - a_1)(b_2 - b_1)(c_2 - c_1)(d_2 - d_1)(e_2 - e_1)\] for all tuples such that \[\tag{2} a_1 + a_2 + b_1 + b_2 + \cdots + e_1 + e_2 \le N\] where $$\tag{3} 0 \le a_1 < a_2, ~ 0 \le b_1 < b_2, \cdots,~ 0 \le e_1 < e_2$$The constraint $N \le 10^9$ makes it worse."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-08-03T00:00:00+00:00"><meta property="article:modified_time" content="2020-08-03T00:00:00+00:00"><meta property="article:tag" content="Math"><meta property="article:tag" content="Counting"><meta property="og:image" content="http://localhost:1313/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/"><meta name=twitter:title content="Generating Functions"><meta name=twitter:description content="Let&rsquo;s look at this math problem from the recent AIsing Programming Contest 2020 on AtCoder.
The problem is to compute the sum of \[\tag{1}(a_2 - a_1)(b_2 - b_1)(c_2 - c_1)(d_2 - d_1)(e_2 - e_1)\] for all tuples such that \[\tag{2} a_1 + a_2 + b_1 + b_2 + \cdots + e_1 + e_2 \le N\] where $$\tag{3} 0 \le a_1 < a_2, ~ 0 \le b_1 < b_2, \cdots,~ 0 \le e_1 < e_2$$The constraint $N \le 10^9$ makes it worse."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Generating Functions","item":"http://localhost:1313/posts/2020-08-03-generating-functions/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Generating Functions","name":"Generating Functions","description":"Let\u0026rsquo;s look at this math problem from the recent AIsing Programming Contest 2020 on AtCoder.\nThe problem is to compute the sum of \\[\\tag{1}(a_2 - a_1)(b_2 - b_1)(c_2 - c_1)(d_2 - d_1)(e_2 - e_1)\\] for all tuples such that \\[\\tag{2} a_1 + a_2 + b_1 + b_2 + \\cdots + e_1 + e_2 \\le N\\] where $$\\tag{3} 0 \\le a_1 \u0026lt; a_2, ~ 0 \\le b_1 \u0026lt; b_2, \\cdots,~ 0 \\le e_1 \u0026lt; e_2$$The constraint $N \\le 10^9$ makes it worse.\n","keywords":["math","counting"],"articleBody":"Let’s look at this math problem from the recent AIsing Programming Contest 2020 on AtCoder.\nThe problem is to compute the sum of \\[\\tag{1}(a_2 - a_1)(b_2 - b_1)(c_2 - c_1)(d_2 - d_1)(e_2 - e_1)\\] for all tuples such that \\[\\tag{2} a_1 + a_2 + b_1 + b_2 + \\cdots + e_1 + e_2 \\le N\\] where $$\\tag{3} 0 \\le a_1 \u003c a_2, ~ 0 \\le b_1 \u003c b_2, \\cdots,~ 0 \\le e_1 \u003c e_2$$The constraint $N \\le 10^9$ makes it worse.\nTo begin, it’s a good idea to cast the differences in the target expression as separate variables. Let’s rename $a_1$ as $a$ and $a_2$ as $a + a’$, so that $a’ = a_2 - a_1$. It’s also a good idea to add a dummy $f \\ge 0$ to $(2)$ to the left side so that it becomes an equation. Under this renaming, things become slightly simpler. We’re now asked to evaluate the sum of \\[\\tag{1*} a’ b’ c’ d’ e’\\]for all tuples such that\\[\\tag{2*} 2(a + b + \\cdots + e) + (a’ + b’ + \\cdots + e’) + f = N \\]where\\[\\tag{3*} \\begin{cases}a, b, \\cdots, e, f \\ge 0 \\\\ a’, b’, c’, d’, e’ \u003e 0\\end{cases}\\]While the target expression $(1*)$ is simpler, we need to find out what to do about $(2*)$. Another greatly used tool in combinatorics is casting these problems in terms of generating functions and obtaining the solution by manipulating the power series.\nA few words on generating functions Consider multiplying two polynomials $f$ and $g$. Question: what exactly does the coefficient of $x^i$ denote? Described purely in words, it is the sum of product of coefficients in any two terms, one from $f$, and one from $g$, so that the sum of degrees of the terms is $i$. We can look at this for more than two polynomials: we pick one term each from every participating polynomial in the product, we find the sum of the degrees, and add the product of these coefficients to that term. We may think of the coefficients, then, as a form of weight for a term.\nThe technique we’re about to employ takes advantage of precisely this. We multiply many series, where each individual series corresponds to a variable. The exponents denote possible values for the variable, and a coefficient intuitively describes the weight in that term. Then the coefficients of the product are the sum of products of these weights.\nSolution We need to derive a generating function from $(2*)$. We’re adding up to $N$ using $11$ non-negative integers, where the first five of them are even (this is because of the coefficient $2$), and the next five of them are strictly positive. We also need to weigh the series that correspond to $a’, b’, \\cdots, e’$ so that we get the sum of $a’b’c’d’e’$ in the resulting product. This can be done by making the coefficient equal to the exponent (so that if $x^i$ is picked, it contributes $i$ to the product). So we obtain the following representation:\\[F(x) = (1 + x^2 + x^4 + \\cdots)^5 (1x + 2x^2 + 3x^3 + \\cdots )^5 (1 + x + x^2 + \\cdots)\\]and we need to find the coefficient of $x^N$ in $F(x)$ to obtain the answer. The first boss move in moving to the solution is noticing\\[x + 2x^2 + 3x^3 + \\cdots = x(1 + x + x^2 + \\cdots)^2\\]so that\\[F(x) = x^5 (1 + x^2 + x^4 + \\cdots)^5(1 + x + x^2 + \\cdots)^{11}\\]We should also remove the stupid $x^5$ because it’s of no use to us, and we can calculate the coefficient of $x^{N-5}$ in\\[F_2(x) = (1 + x^2 + x^4 + \\cdots)^5(1+x+x^2 + \\cdots)^{11}\\]We’ve hit the crux of the problem: what do we do with this? Life would have been much simpler if we had only a single type of exponentiated. Why? Because we have a closed form\\[\\tag{*} (1 + x + x^2 + \\cdots)^n = \\sum_{k = 0}^{\\infty} \\binom{n + k - 1}{k - 1} x^k\\]This is stars-and-bars in terms of generating functions.\nWithout further ado, here’s the big trick:\\[1 + x + x^2 + \\cdots = (1 + x)(1 + x^2 + x^4 + \\cdots)\\]And so\\[F_2(x) = (1+x)^{11} (1+x^2+x^4+\\cdots)^{16}\\]The first part $(1 + x)^{11}$ can be expanded using the binomial theorem, and the second part can be expanded using $(*)$. To evaluate the coefficient of $x^{N-5}$, we loop on the term from the binomial expansion, (say, the $x^i$ term) and multiply its coefficient by the coefficient of $x^{N-5-i}$ in the in the expansion of $(1 + x^2 + x^4 + \\cdots)^{16}$. And we’re done!\nA tiny implementation detail: To compute a binomial coefficient $\\binom{p}{q}$ with large $p$ and small $q$, it’s better to use the following:\\[\\binom{p}{q} = \\frac{p(p-1)\\cdots(p-q+1)}{q!}\\]Most problems involve precomputing factorials and their inverses, but this is not one of them.\n","wordCount":"804","inLanguage":"en","image":"http://localhost:1313/","datePublished":"2020-08-03T00:00:00Z","dateModified":"2020-08-03T00:00:00Z","author":{"@type":"Person","name":"Parth Kohli"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/2020-08-03-generating-functions/"},"publisher":{"@type":"Organization","name":"Parth Kohli","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Home (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/categories/ title=Categories><span>Categories</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li><li><a href=http://localhost:1313/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=http://localhost:1313/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Generating Functions</h1><div class=post-meta><span title='2020-08-03 00:00:00 +0000 UTC'>August 3, 2020</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Parth Kohli</div></header><div class=post-content><p>Let&rsquo;s look at this math problem from the recent <a href=https://atcoder.jp/contests/aising2020/tasks/aising2020_f>AIsing Programming Contest 2020 on AtCoder.</a></p><p>The problem is to compute the sum of \[\tag{1}(a_2 - a_1)(b_2 - b_1)(c_2 - c_1)(d_2 - d_1)(e_2 - e_1)\] for all tuples such that \[\tag{2} a_1 + a_2 + b_1 + b_2 + \cdots + e_1 + e_2 \le N\] where $$\tag{3} 0 \le a_1 &lt; a_2, ~ 0 \le b_1 &lt; b_2, \cdots,~ 0 \le e_1 &lt; e_2$$The constraint $N \le 10^9$ makes it worse.</p><p>To begin, it&rsquo;s a good idea to cast the differences in the target expression as separate variables. Let&rsquo;s rename $a_1$ as $a$ and $a_2$ as $a + a&rsquo;$, so that $a&rsquo; = a_2 - a_1$. It&rsquo;s also a good idea to add a dummy $f \ge 0$ to $(2)$ to the left side so that it becomes an equation. Under this renaming, things become slightly simpler. We&rsquo;re now asked to evaluate the sum of \[\tag{1*} a&rsquo; b&rsquo; c&rsquo; d&rsquo; e&rsquo;\]for all tuples such that\[\tag{2*} 2(a + b + \cdots + e) + (a&rsquo; + b&rsquo; + \cdots + e&rsquo;) + f = N \]where\[\tag{3*} \begin{cases}a, b, \cdots, e, f \ge 0 \\ a&rsquo;, b&rsquo;, c&rsquo;, d&rsquo;, e&rsquo; > 0\end{cases}\]While the target expression $(1*)$ is simpler, we need to find out what to do about $(2*)$. Another greatly used tool in combinatorics is casting these problems in terms of <a href=https://en.wikipedia.org/wiki/Generating_function>generating functions</a> and obtaining the solution by manipulating the power series.</p><h3 id=a-few-words-on-generating-functions>A few words on generating functions<a hidden class=anchor aria-hidden=true href=#a-few-words-on-generating-functions>#</a></h3><p>Consider multiplying two polynomials $f$ and $g$. Question: what exactly does the coefficient of $x^i$ denote? Described purely in words, it is the sum of product of coefficients in any two terms, one from $f$, and one from $g$, so that the sum of degrees of the terms is $i$. We can look at this for more than two polynomials: we pick one term each from every participating polynomial in the product, we find the sum of the degrees, and add the product of these coefficients to that term. We may think of the coefficients, then, as a form of <em>weight</em> for a term.</p><p>The technique we&rsquo;re about to employ takes advantage of precisely this. We multiply many series, where each individual series corresponds to a variable. The exponents denote possible values for the variable, and a coefficient intuitively describes the <em>weight</em> in that term. Then the coefficients of the product are the sum of products of these weights.</p><h3 id=solution>Solution<a hidden class=anchor aria-hidden=true href=#solution>#</a></h3><p>We need to derive a generating function from $(2*)$. We&rsquo;re adding up to $N$ using $11$ non-negative integers, where the first five of them are even (this is because of the coefficient $2$), and the next five of them are strictly positive. We also need to weigh the series that correspond to $a&rsquo;, b&rsquo;, \cdots, e&rsquo;$ so that we get the sum of $a&rsquo;b&rsquo;c&rsquo;d&rsquo;e&rsquo;$ in the resulting product. This can be done by making the <strong>coefficient equal to the exponent</strong> (so that if $x^i$ is picked, it contributes $i$ to the product). So we obtain the following representation:\[F(x) = (1 + x^2 + x^4 + \cdots)^5 (1x + 2x^2 + 3x^3 + \cdots )^5 (1 + x + x^2 + \cdots)\]and we need to find the coefficient of $x^N$ in $F(x)$ to obtain the answer. The first boss move in moving to the solution is noticing\[x + 2x^2 + 3x^3 + \cdots = x(1 + x + x^2 + \cdots)^2\]so that\[F(x) = x^5 (1 + x^2 + x^4 + \cdots)^5(1 + x + x^2 + \cdots)^{11}\]We should also remove the stupid $x^5$ because it&rsquo;s of no use to us, and we can calculate the coefficient of $x^{N-5}$ in\[F_2(x) = (1 + x^2 + x^4 + \cdots)^5(1+x+x^2 + \cdots)^{11}\]We&rsquo;ve hit the crux of the problem: what do we do with this? Life would have been much simpler if we had only a single type of exponentiated. Why? Because we have a closed form\[\tag{*} (1 + x + x^2 + \cdots)^n = \sum_{k = 0}^{\infty} \binom{n + k - 1}{k - 1} x^k\]This is <a href=https://en.wikipedia.org/wiki/Stars_and_bars_(combinatorics)>stars-and-bars</a> in terms of generating functions.</p><p>Without further ado, here&rsquo;s the <strong>big trick</strong>:\[1 + x + x^2 + \cdots = (1 + x)(1 + x^2 + x^4 + \cdots)\]And so\[F_2(x) = (1+x)^{11} (1+x^2+x^4+\cdots)^{16}\]The first part $(1 + x)^{11}$ can be expanded using the <a href=https://en.wikipedia.org/wiki/Binomial_theorem>binomial theorem</a>, and the second part can be expanded using $(*)$. To evaluate the coefficient of $x^{N-5}$, we loop on the term from the binomial expansion, (say, the $x^i$ term) and multiply its coefficient by the coefficient of $x^{N-5-i}$ in the in the expansion of $(1 + x^2 + x^4 + \cdots)^{16}$. And we&rsquo;re done!</p><p>A tiny implementation detail: To compute a binomial coefficient $\binom{p}{q}$ with large $p$ and small $q$, it&rsquo;s better to use the following:\[\binom{p}{q} = \frac{p(p-1)\cdots(p-q+1)}{q!}\]Most problems involve precomputing factorials and their inverses, but this is not one of them.</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/math/>Math</a></li><li><a href=http://localhost:1313/tags/counting/>Counting</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/2022-02-05-random-or/><span class=title>« Prev</span><br><span>Random OR</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>Parth Kohli</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>